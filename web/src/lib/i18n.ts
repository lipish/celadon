/**
 * 中英双语，key 与中文一致便于对照
 */
export type Locale = "zh" | "en";

const messages: Record<Locale, Record<string, string>> = {
  zh: {
    appName: "Celadon",
    tagline: "持续交互式开发流程 · Continuous Interactive Dev",
    headline1: "把",
    headline2: "想法",
    headline3: "变成",
    headline4: "可部署的软件",
    subtitle: "提交一个想法，Celadon 自动完成需求澄清、PRD 生成、AI 驱动开发与部署。",
    poweredBy: "Powered by Zene · Planner / Executor / Reflector loop",
    hintInput: "支持中英文描述 · 无需精确规格 · AI 会帮你澄清",
    start: "启动",
    docs: "文档",
    api: "API",
    getStarted: "开始使用",
    recentProjects: "最近项目",
    viewAll: "查看全部",
    continueWork: "继续",
    newIdea: "新想法",
    flowOverview: "流程概览",
    projects: "项目",
    viewRepo: "查看仓库",
    selectProject: "选择项目",
    clarify: "澄清",
    prd: "需求文档",
    dev: "开发",
    deploy: "部署",
    iterate: "迭代",
    stageClarify: "Clarify",
    stagePrd: "PRD",
    stageDev: "Development · Zene",
    stageDeploy: "Deploy",
    stageIterate: "Iterate",
    back: "返回",
    generatePrd: "生成 PRD",
    enterDev: "进入开发",
    startDev: "启动开发",
    starting: "正在启动...",
    noRecentProjects: "暂无历史项目，输入上方想法开始",
    justNow: "刚刚",
    minutesAgo: "分钟前",
    hoursAgo: "小时前",
    clarifyTitle: "需求澄清",
    clarifySubtitle: "与 AI 多轮对话澄清需求",
    prdTitle: "PRD",
    currentProject: "当前项目",
    sections: "章节",
    copyMd: "复制 MD",
    copied: "已复制",
    thinking: "正在思考...",
    login: "登录",
    register: "注册",
    logout: "退出登录",
    settings: "设置",
    profile: "个人信息",
    changePassword: "修改密码",
    english: "English",
    heroSubtitle: "从想法到代码，Celadon 助你构建专业级的全栈应用",
    examplesTitle: "精彩范例",
    examplesSubtitle: "看看 Celadon 已经帮助开发者构建了什么",
    saasBillingTitle: "SaaS 账单后台",
    saasBillingDesc: "帮助独立开发者管理 SaaS 订阅与账单的后台管理系统，支持多货币与税率配置",
    aiReviewerTitle: "AI 代码审查",
    aiReviewerDesc: "基于大模型的代码审查工具，自动检测安全漏洞、性能问题和代码规范",
    apiCollabTitle: "API 设计平台",
    apiCollabDesc: "实时协作的 API 设计平台，支持团队共同编写 OpenAPI 3.1 规范",
    viewDetails: "查看详情",
    interactiveLoopTitle: "交互式开发循环",
    interactiveLoopSubtitle: "Celadon 不仅仅是代码生成器。它采用特殊的需求澄清 → PRD → 开发 → 迭代循环，确保每一行代码都符合你的真实意图。",
    loopItem1: "AI 辅助需求对齐",
    loopItem2: "自动生成标准化 PRD",
    loopItem3: "闭环式 AI 代码编写",
    loopItem4: "一键预览与部署",
    persistenceTitle: "物料持久化与持续迭代",
    persistenceDesc: "所有开发物料（代码、文档、配置）均受版本控制并持久化。你可以随时在已部署的生产环境下发起新一轮迭代，持续进化你的应用。",
    processClarify: "需求澄清",
    processPrd: "PRD 生成",
    processDev: "AI 开发",
    processDeploy: "一键部署",
    processIterate: "持续迭代",
    getStartedButton: "开始使用",
    prdReady: "PRD 已就绪",
    prdReadyDesc: "确认需求文档后，Celadon 将启动 Zene 执行开发任务",
    prdInfo: "文档信息",
    prdVersion: "版本",
    prdStatus: "状态",
    prdMethod: "生成方式",
    prdTemplate: "模板",
    prdDraft: "草稿",
    prdStandard: "标准 PRD",
    prdGenerating: "正在生成 PRD 文档...",
    prdNoContent: "暂无内容",
    prdNoContentHint: "请确认后端已配置 LLM（如 DEEPSEEK_API_KEY），并重试「生成 PRD」。",
    prdSuccess: "已生成",
    prdChapter: "章节",
    prdWords: "词",
    prdQuickAction: "快速操作",
    unknownProject: "未知项目",
    prdError: "生成失败",
    prdErrorHint: "生成失败，请返回需求澄清阶段重试。",
    waitingListTitle: "加入等候名单",
    waitingListSubtitle: "目前我们的开发名额已满。留下你的邮箱和想法，我们会在开放时第一时间通知你。",
    waitingListEmailPlaceholder: "你的邮箱",
    waitingListSubmit: "提交申请",
    waitingListSuccess: "已成功加入等候名单！我们会尽快联系你。",
    waitingListError: "提交失败，请稍后重试。",
  },
  en: {
    appName: "Celadon",
    tagline: "Continuous Interactive Dev",
    headline1: "Turn",
    headline2: "ideas",
    headline3: "into",
    headline4: "deployable software",
    subtitle: "Submit an idea; Celadon handles clarification, PRD, AI-driven development and deployment.",
    poweredBy: "Powered by Zene · Planner / Executor / Reflector loop",
    hintInput: "Describe in any language · No precise spec needed · AI will clarify",
    start: "Start",
    docs: "Docs",
    api: "API",
    getStarted: "Get started",
    recentProjects: "Recent projects",
    viewAll: "View all",
    continueWork: "Continue",
    newIdea: "New idea",
    flowOverview: "Flow overview",
    projects: "Projects",
    viewRepo: "View repo",
    selectProject: "Select project",
    clarify: "Clarify",
    prd: "PRD",
    dev: "Dev",
    deploy: "Deploy",
    iterate: "Iterate",
    stageClarify: "Clarify",
    stagePrd: "PRD",
    stageDev: "Development · Zene",
    stageDeploy: "Deploy",
    stageIterate: "Iterate",
    back: "Back",
    generatePrd: "Generate PRD",
    enterDev: "Enter dev",
    startDev: "Start dev",
    starting: "Starting...",
    noRecentProjects: "No projects yet. Enter an idea above to start.",
    justNow: "just now",
    minutesAgo: "m ago",
    hoursAgo: "h ago",
    clarifyTitle: "Clarify",
    clarifySubtitle: "Multi-turn dialogue with AI",
    prdTitle: "PRD",
    currentProject: "Current project",
    sections: "Sections",
    copyMd: "Copy MD",
    copied: "Copied",
    thinking: "Thinking...",
    login: "Login",
    register: "Register",
    logout: "Logout",
    settings: "Settings",
    profile: "Profile",
    changePassword: "Change Password",
    language: "Language",
    chinese: "Chinese",
    english: "English",
    heroSubtitle: "From idea to code, Celadon helps you build professional full-stack apps",
    examplesTitle: "Featured Examples",
    examplesSubtitle: "See what Celadon has helped developers build",
    saasBillingTitle: "SaaS Billing Dashboard",
    saasBillingDesc: "Management system for SaaS subscriptions and billing, supports multi-currency and tax rates",
    aiReviewerTitle: "AI Code Reviewer",
    aiReviewerDesc: "LLM-based code review tool, automatically detects security vulnerabilities and performance issues",
    apiCollabTitle: "API Design Platform",
    apiCollabDesc: "Real-time collaborative API design platform, supporting OpenAPI 3.1 specifications",
    viewDetails: "View Details",
    interactiveLoopTitle: "Interactive Development Loop",
    interactiveLoopSubtitle: "Celadon is more than a code generator. It uses a unique Clarify → PRD → Dev → Iterate loop to ensure every line of code aligns with your intent.",
    loopItem1: "AI-assisted Alignment",
    loopItem2: "Auto-standardized PRD",
    loopItem3: "Closed-loop AI Coding",
    loopItem4: "One-click Preview & Deploy",
    persistenceTitle: "Artifact Persistence & Continuous Iteration",
    persistenceDesc: "All artifacts (code, docs, config) are versioned and persisted. You can initiate new iterations on deployed environments at any time, evolving your application continuously.",
    processClarify: "Clarification",
    processPrd: "PRD Generation",
    processDev: "AI Development",
    processDeploy: "One-click Deploy",
    processIterate: "Continuous Iteration",
    getStartedButton: "Get Started",
    prdReady: "PRD Ready",
    prdReadyDesc: "Once confirmed, Celadon starts Zene to execute development tasks",
    prdInfo: "Document Info",
    prdVersion: "Version",
    prdStatus: "Status",
    prdMethod: "Method",
    prdTemplate: "Template",
    prdDraft: "Draft",
    prdStandard: "Standard PRD",
    prdGenerating: "Generating PRD document...",
    prdNoContent: "No Content",
    prdNoContentHint: "Please ensure LLM is configured (e.g., DEEPSEEK_API_KEY) and retry 'Generate PRD'.",
    prdSuccess: "Generated",
    prdChapter: "Chapters",
    prdWords: "words",
    prdQuickAction: "Quick Actions",
    unknownProject: "Unknown Project",
    prdError: "Generation Failed",
    prdErrorHint: "Generation failed, please return to Clarify stage and retry.",
    waitingListTitle: "Join Waiting List",
    waitingListSubtitle: "Our development quota is currently full. Leave your email and idea, and we'll notify you as soon as it opens.",
    waitingListEmailPlaceholder: "Your email",
    waitingListSubmit: "Submit Application",
    waitingListSuccess: "Successfully joined the waiting list! We'll contact you soon.",
    waitingListError: "Submission failed, please try again later.",
  },
};

const STORAGE_KEY = "celadon-locale";

export function getStoredLocale(): Locale {
  try {
    const v = localStorage.getItem(STORAGE_KEY);
    if (v === "zh" || v === "en") return v;
  } catch { }
  return "zh";
}

export function setStoredLocale(locale: Locale): void {
  try {
    localStorage.setItem(STORAGE_KEY, locale);
  } catch { }
}

export function getT(locale: Locale): (key: string) => string {
  const m = messages[locale] ?? messages.zh;
  return (key: string) => m[key] ?? messages.zh[key] ?? key;
}

export { messages };
